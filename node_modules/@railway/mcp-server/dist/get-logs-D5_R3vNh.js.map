{"version":3,"file":"get-logs-D5_R3vNh.js","names":["result: string","error: unknown"],"sources":["../src/tools/get-logs.ts"],"sourcesContent":["import z from \"zod\";\nimport { getRailwayBuildLogs, getRailwayDeployLogs } from \"../cli\";\nimport type { GetLogsOptions as GetLogsOptionsType } from \"../cli/logs\";\nimport { getCliFeatureSupport } from \"../cli/version\";\nimport { createToolResponse } from \"../utils\";\n\ntype GetLogsOptions = {\n  logType: \"build\" | \"deploy\";\n  lines?: number;\n  filter?: string;\n  json?: boolean;\n} & GetLogsOptionsType;\n\nexport const getLogsTool = {\n  name: \"get-logs\",\n  title: \"Get Railway Logs\",\n  description:\n    \"Get build or deployment logs for the currently linked Railway project. This will only pull the latest successful deployment by default, so if you need to inspect a failed build, you'll need to supply a deployment ID. You can optionally specify a deployment ID, service, and environment. If no deployment ID is provided, it will get logs from the latest deployment. The 'lines' and 'filter' parameters require Railway CLI v4.9.0+. Use 'lines' to limit the number of log lines (disables streaming) and 'filter' to search logs by terms or attributes (e.g., '@level:error', 'user', '@level:warn AND rate limit'). For older CLI versions, these parameters will be ignored and logs will stream.\",\n  inputSchema: {\n    workspacePath: z\n      .string()\n      .describe(\"The path to the workspace to get logs from\"),\n    logType: z\n      .enum([\"build\", \"deploy\"])\n      .describe(\n        \"Type of logs to retrieve: 'build' for build logs or 'deploy' for deployment logs\"\n      ),\n    deploymentId: z\n      .string()\n      .optional()\n      .describe(\n        \"Deployment ID to pull logs from. Omit to pull from latest deployment\"\n      ),\n    service: z\n      .string()\n      .optional()\n      .describe(\"Service to view logs from (defaults to linked service)\"),\n    environment: z\n      .string()\n      .optional()\n      .describe(\n        \"Environment to view logs from (defaults to linked environment)\"\n      ),\n    lines: z\n      .number()\n      .optional()\n      .describe(\n        \"Number of log lines to return (disables streaming). Requires Railway CLI v4.9.0+. Useful for searching through recent logs.\"\n      ),\n    filter: z\n      .string()\n      .optional()\n      .describe(\n        \"Filter logs by search terms or attributes. Requires Railway CLI v4.9.0+. Examples: 'error', '@level:error', '@level:warn AND rate limit', 'user login', '@status:500'. See https://docs.railway.com/guides/logs for more info.\"\n      ),\n    json: z\n      .boolean()\n      .optional()\n      .describe(\n        \"JSON provides structured log data with more information (e.g. timestamps) but uses more tokens. Defaults to false to save tokens. Set to true for more detailed logs.\"\n      ),\n  },\n  handler: async ({\n    workspacePath,\n    logType,\n    deploymentId,\n    service,\n    environment,\n    lines,\n    filter,\n    json,\n  }: GetLogsOptions) => {\n    try {\n      const features = await getCliFeatureSupport();\n      const supportsFiltering =\n        features.logs.args.lines && features.logs.args.filter;\n      let versionWarning = \"\";\n\n      if ((lines !== undefined || filter !== undefined) && !supportsFiltering) {\n        versionWarning =\n          \"⚠️ **Note:** Your Railway CLI version does not support the 'lines' and 'filter' parameters. \" +\n          \"Please upgrade to Railway CLI v4.9.0 or later to use these features. \" +\n          \"Logs will be streamed without filtering.\\n\\n\";\n      }\n\n      let result: string;\n      if (logType === \"build\") {\n        result = await getRailwayBuildLogs({\n          workspacePath,\n          deploymentId,\n          service,\n          environment,\n          lines,\n          filter,\n          json,\n        });\n      } else {\n        result = await getRailwayDeployLogs({\n          workspacePath,\n          deploymentId,\n          service,\n          environment,\n          lines,\n          filter,\n          json,\n        });\n      }\n\n      return createToolResponse(versionWarning + result);\n    } catch (error: unknown) {\n      const errorMessage =\n        error instanceof Error ? error.message : \"Unknown error occurred\";\n      return createToolResponse(\n        `❌ Failed to get Railway ${logType} logs\\n\\n` +\n          `**Error:** ${errorMessage}\\n\\n` +\n          \"**Next Steps:**\\n\" +\n          \"• Ensure you have a Railway project linked\\n\" +\n          \"• Check that the deployment ID is valid (if provided)\\n\" +\n          \"• Verify the service and environment exist\\n\" +\n          \"• Run `railway link` to ensure proper project connection\"\n      );\n    }\n  },\n};\n"],"mappings":";;;;;;AAaA,MAAa,cAAc;CACzB,MAAM;CACN,OAAO;CACP,aACE;CACF,aAAa;EACX,eAAe,EACZ,QAAQ,CACR,SAAS,6CAA6C;EACzD,SAAS,EACN,KAAK,CAAC,SAAS,SAAS,CAAC,CACzB,SACC,mFACD;EACH,cAAc,EACX,QAAQ,CACR,UAAU,CACV,SACC,uEACD;EACH,SAAS,EACN,QAAQ,CACR,UAAU,CACV,SAAS,yDAAyD;EACrE,aAAa,EACV,QAAQ,CACR,UAAU,CACV,SACC,iEACD;EACH,OAAO,EACJ,QAAQ,CACR,UAAU,CACV,SACC,8HACD;EACH,QAAQ,EACL,QAAQ,CACR,UAAU,CACV,SACC,iOACD;EACH,MAAM,EACH,SAAS,CACT,UAAU,CACV,SACC,wKACD;EACJ;CACD,SAAS,OAAO,EACd,eACA,SACA,cACA,SACA,aACA,OACA,QACA,WACoB;AACpB,MAAI;GACF,MAAM,WAAW,MAAM,sBAAsB;GAC7C,MAAM,oBACJ,SAAS,KAAK,KAAK,SAAS,SAAS,KAAK,KAAK;GACjD,IAAI,iBAAiB;AAErB,QAAK,UAAU,UAAa,WAAW,WAAc,CAAC,kBACpD,kBACE;GAKJ,IAAIA;AACJ,OAAI,YAAY,QACd,UAAS,MAAM,oBAAoB;IACjC;IACA;IACA;IACA;IACA;IACA;IACA;IACD,CAAC;OAEF,UAAS,MAAM,qBAAqB;IAClC;IACA;IACA;IACA;IACA;IACA;IACA;IACD,CAAC;AAGJ,UAAO,mBAAmB,iBAAiB,OAAO;WAC3CC,OAAgB;GACvB,MAAM,eACJ,iBAAiB,QAAQ,MAAM,UAAU;AAC3C,UAAO,mBACL,2BAA2B,QAAQ,sBACnB,aAAa;;;;4DAM9B;;;CAGN"}