{"version":3,"file":"projects-ENU6yIz7.js","names":["error: unknown"],"sources":["../src/cli/projects.ts"],"sourcesContent":["import {\n\tcheckRailwayCliStatus,\n\trunRailwayCommand,\n\trunRailwayJsonCommand,\n} from \"./core\";\nimport { analyzeRailwayError, ERROR_PATTERNS } from \"./error-handling\";\n\nexport type RailwayProject = {\n\tid: string;\n\tname: string;\n\tteam?: {\n\t\tname: string;\n\t};\n\tenvironments?: {\n\t\tedges?: Array<{\n\t\t\tnode: {\n\t\t\t\tname: string;\n\t\t\t};\n\t\t}>;\n\t};\n\tservices?: {\n\t\tedges?: Array<{\n\t\t\tnode: {\n\t\t\t\tname: string;\n\t\t\t};\n\t\t}>;\n\t};\n\tcreatedAt: string;\n\tupdatedAt: string;\n};\n\nexport type GetLinkedProjectInfoOptions = {\n\tworkspacePath: string;\n};\n\nexport const getLinkedProjectInfo = async ({\n\tworkspacePath,\n}: GetLinkedProjectInfoOptions): Promise<{\n\tsuccess: boolean;\n\tproject?: RailwayProject;\n\terror?: string;\n}> => {\n\ttry {\n\t\tawait checkRailwayCliStatus();\n\t\tconst project = await runRailwayJsonCommand(\n\t\t\t\"railway status --json\",\n\t\t\tworkspacePath,\n\t\t);\n\n\t\tif (!project || typeof project !== \"object\") {\n\t\t\treturn { success: false, error: \"Invalid response from Railway CLI\" };\n\t\t}\n\n\t\treturn { success: true, project: project as RailwayProject };\n\t} catch (error: unknown) {\n\t\tconst errorMessage = error instanceof Error ? error.message : String(error);\n\n\t\t// Check if it's a \"no linked project\" error\n\t\tif (ERROR_PATTERNS.NO_LINKED_PROJECT.test(errorMessage)) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\terror:\n\t\t\t\t\t\"No Railway project is linked. Run 'railway link' to connect to a project\",\n\t\t\t};\n\t\t}\n\n\t\treturn { success: false, error: errorMessage };\n\t}\n};\n\nexport const listRailwayProjects = async (): Promise<RailwayProject[]> => {\n\ttry {\n\t\tawait checkRailwayCliStatus();\n\t\tconst projects = await runRailwayJsonCommand(\"railway list --json\");\n\n\t\tif (!Array.isArray(projects)) {\n\t\t\tthrow new Error(\"Unexpected response format from Railway CLI\");\n\t\t}\n\n\t\treturn projects;\n\t} catch (error: unknown) {\n\t\treturn analyzeRailwayError(error, \"railway list --json\");\n\t}\n};\n\nexport type CreateProjectOptions = {\n\tprojectName: string;\n\tworkspacePath: string;\n};\n\nexport const createRailwayProject = async ({\n\tprojectName,\n\tworkspacePath,\n}: CreateProjectOptions): Promise<string> => {\n\ttry {\n\t\tawait checkRailwayCliStatus();\n\n\t\t// Check if there's already a linked project\n\t\tconst linkedProjectResult = await getLinkedProjectInfo({ workspacePath });\n\t\tif (linkedProjectResult.success && linkedProjectResult.project) {\n\t\t\treturn \"A Railway project is already linked to this workspace. No new project created.\";\n\t\t}\n\n\t\tconst { output: initOutput } = await runRailwayCommand(\n\t\t\t`railway init --name ${projectName}`,\n\t\t\tworkspacePath,\n\t\t);\n\t\tconst { output: linkOutput } = await runRailwayCommand(\n\t\t\t`railway link -p ${projectName}`,\n\t\t\tworkspacePath,\n\t\t);\n\n\t\treturn `${initOutput}\\n${linkOutput}`;\n\t} catch (error: unknown) {\n\t\treturn analyzeRailwayError(error, `railway init --name ${projectName}`);\n\t}\n};\n"],"mappings":";;;;AAmCA,MAAa,uBAAuB,OAAO,EAC1C,oBAKK;AACL,KAAI;AACH,QAAM,uBAAuB;EAC7B,MAAM,UAAU,MAAM,sBACrB,yBACA,cACA;AAED,MAAI,CAAC,WAAW,OAAO,YAAY,SAClC,QAAO;GAAE,SAAS;GAAO,OAAO;GAAqC;AAGtE,SAAO;GAAE,SAAS;GAAe;GAA2B;UACpDA,OAAgB;EACxB,MAAM,eAAe,iBAAiB,QAAQ,MAAM,UAAU,OAAO,MAAM;AAG3E,MAAI,eAAe,kBAAkB,KAAK,aAAa,CACtD,QAAO;GACN,SAAS;GACT,OACC;GACD;AAGF,SAAO;GAAE,SAAS;GAAO,OAAO;GAAc;;;AAIhD,MAAa,sBAAsB,YAAuC;AACzE,KAAI;AACH,QAAM,uBAAuB;EAC7B,MAAM,WAAW,MAAM,sBAAsB,sBAAsB;AAEnE,MAAI,CAAC,MAAM,QAAQ,SAAS,CAC3B,OAAM,IAAI,MAAM,8CAA8C;AAG/D,SAAO;UACCA,OAAgB;AACxB,SAAO,oBAAoB,OAAO,sBAAsB;;;AAS1D,MAAa,uBAAuB,OAAO,EAC1C,aACA,oBAC4C;AAC5C,KAAI;AACH,QAAM,uBAAuB;EAG7B,MAAM,sBAAsB,MAAM,qBAAqB,EAAE,eAAe,CAAC;AACzE,MAAI,oBAAoB,WAAW,oBAAoB,QACtD,QAAO;EAGR,MAAM,EAAE,QAAQ,eAAe,MAAM,kBACpC,uBAAuB,eACvB,cACA;EACD,MAAM,EAAE,QAAQ,eAAe,MAAM,kBACpC,mBAAmB,eACnB,cACA;AAED,SAAO,GAAG,WAAW,IAAI;UACjBA,OAAgB;AACxB,SAAO,oBAAoB,OAAO,uBAAuB,cAAc"}