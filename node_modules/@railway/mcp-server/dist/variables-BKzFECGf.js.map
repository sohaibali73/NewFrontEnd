{"version":3,"file":"variables-BKzFECGf.js","names":["error: unknown"],"sources":["../src/cli/variables.ts"],"sourcesContent":["import { checkRailwayCliStatus, runRailwayCommand } from \"./core\";\nimport { analyzeRailwayError } from \"./error-handling\";\nimport { getLinkedProjectInfo } from \"./projects\";\n\nexport type ListVariablesOptions = {\n\tworkspacePath: string;\n\tservice?: string;\n\tenvironment?: string;\n\tkv?: boolean;\n\tjson?: boolean;\n};\n\nexport const listRailwayVariables = async ({\n\tworkspacePath,\n\tservice,\n\tenvironment,\n\tkv,\n\tjson,\n}: ListVariablesOptions): Promise<string> => {\n\ttry {\n\t\tawait checkRailwayCliStatus();\n\t\tconst result = await getLinkedProjectInfo({ workspacePath });\n\t\tif (!result.success) {\n\t\t\tthrow new Error(result.error);\n\t\t}\n\n\t\tlet command = \"railway variables\";\n\n\t\tif (service) {\n\t\t\tcommand += ` --service ${service}`;\n\t\t}\n\t\tif (environment) {\n\t\t\tcommand += ` --environment ${environment}`;\n\t\t}\n\t\tif (kv) {\n\t\t\tcommand += \" --kv\";\n\t\t}\n\t\tif (json) {\n\t\t\tcommand += \" --json\";\n\t\t}\n\n\t\tconst { output } = await runRailwayCommand(command, workspacePath);\n\t\treturn output;\n\t} catch (error: unknown) {\n\t\treturn analyzeRailwayError(error, \"railway variables\");\n\t}\n};\n\nexport type SetVariablesOptions = {\n\tworkspacePath: string;\n\tvariables: string[];\n\tservice?: string;\n\tenvironment?: string;\n\tskipDeploys?: boolean;\n};\n\nexport const setRailwayVariables = async ({\n\tworkspacePath,\n\tvariables,\n\tservice,\n\tenvironment,\n\tskipDeploys,\n}: SetVariablesOptions): Promise<string> => {\n\ttry {\n\t\tawait checkRailwayCliStatus();\n\t\tconst result = await getLinkedProjectInfo({ workspacePath });\n\t\tif (!result.success) {\n\t\t\tthrow new Error(result.error);\n\t\t}\n\n\t\tlet command = \"railway variables\";\n\n\t\tif (service) {\n\t\t\tcommand += ` --service ${service}`;\n\t\t}\n\t\tif (environment) {\n\t\t\tcommand += ` --environment ${environment}`;\n\t\t}\n\t\tif (skipDeploys) {\n\t\t\tcommand += \" --skip-deploys\";\n\t\t}\n\n\t\t// Add each variable with --set flag\n\t\tvariables.forEach((variable) => {\n\t\t\tcommand += ` --set \"${variable}\"`;\n\t\t});\n\n\t\tconst { output } = await runRailwayCommand(command, workspacePath);\n\t\treturn output;\n\t} catch (error: unknown) {\n\t\treturn analyzeRailwayError(error, \"railway variables --set\");\n\t}\n};\n"],"mappings":";;;;;AAYA,MAAa,uBAAuB,OAAO,EAC1C,eACA,SACA,aACA,IACA,WAC4C;AAC5C,KAAI;AACH,QAAM,uBAAuB;EAC7B,MAAM,SAAS,MAAM,qBAAqB,EAAE,eAAe,CAAC;AAC5D,MAAI,CAAC,OAAO,QACX,OAAM,IAAI,MAAM,OAAO,MAAM;EAG9B,IAAI,UAAU;AAEd,MAAI,QACH,YAAW,cAAc;AAE1B,MAAI,YACH,YAAW,kBAAkB;AAE9B,MAAI,GACH,YAAW;AAEZ,MAAI,KACH,YAAW;EAGZ,MAAM,EAAE,WAAW,MAAM,kBAAkB,SAAS,cAAc;AAClE,SAAO;UACCA,OAAgB;AACxB,SAAO,oBAAoB,OAAO,oBAAoB;;;AAYxD,MAAa,sBAAsB,OAAO,EACzC,eACA,WACA,SACA,aACA,kBAC2C;AAC3C,KAAI;AACH,QAAM,uBAAuB;EAC7B,MAAM,SAAS,MAAM,qBAAqB,EAAE,eAAe,CAAC;AAC5D,MAAI,CAAC,OAAO,QACX,OAAM,IAAI,MAAM,OAAO,MAAM;EAG9B,IAAI,UAAU;AAEd,MAAI,QACH,YAAW,cAAc;AAE1B,MAAI,YACH,YAAW,kBAAkB;AAE9B,MAAI,YACH,YAAW;AAIZ,YAAU,SAAS,aAAa;AAC/B,cAAW,WAAW,SAAS;IAC9B;EAEF,MAAM,EAAE,WAAW,MAAM,kBAAkB,SAAS,cAAc;AAClE,SAAO;UACCA,OAAgB;AACxB,SAAO,oBAAoB,OAAO,0BAA0B"}